'use strict';

const React = require('react');
const ReactDOMServer = require('react-dom/server');

const Email = require('./lib/Email').default;
const createHTML = require('./server/createHTML');
const types = require('./src/types');

/**
 * Creates and returns an email
 *
 * @param {Object} options
 * @param {Object} options.data
 * @param {String} options.type - Must be one of `types`
 * @param {String} options.subject
 *
 * @return {Promise}
 */
function create(options) {
  const email = React.createElement(Email, options);
  const content = ReactDOMServer.renderToStaticMarkup(email);

  // Create the HTML page and return it
  return createHTML(content, {
    subject:
    options.subject,
    trackingSrc: options.data.tracking_pixel_url,
  });
}

module.exports = {
  create,
  types,
}

